<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hotel Offers</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
body {
	background-color: #f8f9fa;
	font-family: "Poppins", sans-serif;
}

.container {
	max-width: 1100px;
}

/* Search Form */
.search-form {
	background: #ffffff;
	padding: 20px;
	border-radius: 12px;
	box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
	margin-bottom: 30px;
}

.form-control {
	border-radius: 8px;
	padding: 12px;
	font-size: 16px;
}

.search-btn {
	background: #007bff;
	color: white;
	font-weight: bold;
	padding: 12px;
	border-radius: 8px;
	transition: 0.3s;
}

.search-btn:hover {
	background: #0056b3;
}

/* Hotel Cards */
.hotel-card {
	display: flex;
	border-radius: 12px;
	overflow: hidden;
	background: white;
	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
	transition: 0.3s;
	margin-bottom: 20px;
}

.hotel-card:hover {
	transform: translateY(-5px);
}

.hotel-image {
	width: 180px;
	height: auto;
	object-fit: cover;
}

.card-body {
	padding: 20px;
	flex: 1;
}

.card-title {
	font-size: 20px;
	font-weight: bold;
}

.card-text {
	font-size: 15px;
	color: #666;
}

.offer-price {
	font-size: 18px;
	font-weight: bold;
	color: #28a745;
}

/* Pagination */
.pagination {
	justify-content: center;
	margin-top: 20px;
}

.pagination .page-link {
	border-radius: 8px;
}

.pagination .page-item.active .page-link {
	background: #007bff;
	border-color: #007bff;
	color: white;
}
</style>
</head>

<body>
	<div class="container mt-5">
		<h2 class="text-center mb-4">üè® Exclusive Hotel Offers</h2>

		<!-- Search Form -->
		<form id="searchForm" class="search-form"
			onsubmit="event.preventDefault(); searchOffers();">
			<div class="row g-3">
				<div class="col-md-5">
					<div class="input-group">
						<span class="input-group-text"><i
							class="fas fa-map-marker-alt"></i></span> <input type="text"
							id="originCity" class="form-control" placeholder="Origin City"
							required>
					</div>
				</div>
				<div class="col-md-5">
					<div class="input-group">
						<span class="input-group-text"><i class="fas fa-plane"></i></span>
						<input type="text" id="destinationCity" class="form-control"
							placeholder="Destination City" required>
					</div>
				</div>
				<div class="col-md-2">
					<button type="submit" class="btn search-btn w-100">
						<i class="fas fa-search"></i> Search
					</button>
				</div>
			</div>
		</form>

		<div id="hotelCardsContainer" class="row">
			<!-- Cards will be inserted here by JavaScript -->
		</div>
		 

		<!-- Pagination -->
		<nav>
			<ul class="pagination">
				<li class="page-item">
					<button class="page-link" id="prevPage" onclick="changePage(-1)">Previous</button>
				</li>
				<li class="page-item">
					<button class="page-link" id="nextPage" onclick="changePage(1)">Next</button>
				</li>
			</ul>
		</nav>
	</div>
	<script>
	document.addEventListener("DOMContentLoaded", function () {
	    fetchOffers(); // Load all offers initially
	});

	let currentPage = 1;
	const itemsPerPage = 2;
	let filteredOffers = [];

	function fetchOffers(originCity = "", destinationCity = "") {
	    const apiUrl = originCity || destinationCity
	        ? `/api/offers/search?originCity=${originCity}&destinationCity=${destinationCity}`
	        : `/api/offers`;

	    fetch(apiUrl)
	        .then(response => response.json())
	        .then(data => {
	            filteredOffers = data;
	            currentPage = 1;
	            renderHotelCards();
	            updatePaginationButtons();
	        })
	        .catch(error => console.error("Error fetching offers:", error));
	}

	function renderHotelCards() {
	    const startIndex = (currentPage - 1) * itemsPerPage;
	    const endIndex = startIndex + itemsPerPage;
	    const currentOffers = filteredOffers.slice(startIndex, endIndex);
	    const hotelCardsContainer = document.getElementById("hotelCardsContainer");
	    hotelCardsContainer.innerHTML = "";

	    currentOffers.forEach(offer => {
	        const card = `
	            <div class="col-md-6">
	                <div class="hotel-card">
	                    <img src="${offer.image || 'https://via.placeholder.com/180'}" class="hotel-image" alt="${offer.hotelName}">
	                    <div class="card-body">
	                        <h5 class="card-title">${offer.hotelName}</h5>
	                        <p class="card-text">From: ${offer.from} to ${offer.to}</p>
	                        <p class="card-text">Travel End Date: ${offer.travelEndDate}</p>
	                        <p class="offer-price">Offer Price: ${offer.offerPrice}</p>
	                        <p class="card-text"><i class="fas fa-map-marker-alt"></i> ${offer.originCity} ‚Üí <i class="fas fa-plane"></i> ${offer.destinationCity}</p>
	                    </div>
	                </div>
	            </div>
	        `;
	        hotelCardsContainer.innerHTML += card;
	    });

	    updatePaginationButtons();
	}

	function updatePaginationButtons() {
	    document.getElementById("prevPage").disabled = currentPage === 1;
	    document.getElementById("nextPage").disabled = currentPage * itemsPerPage >= filteredOffers.length;
	}

	function changePage(direction) {
	    const totalPages = Math.ceil(filteredOffers.length / itemsPerPage);
	    
	    if ((direction === -1 && currentPage === 1) || (direction === 1 && currentPage >= totalPages)) {
	        return; // Prevent going out of bounds
	    }

	    currentPage += direction;
	    renderHotelCards();
	}

	function searchOffers() {
	    const originCity = document.getElementById("originCity").value.trim();
	    const destinationCity = document.getElementById("destinationCity").value.trim();
	    fetchOffers(originCity, destinationCity);
	}
	</script>